import os
import asn1tools


class e2sm_kpm_packer(object):
    def __init__(self) -> None:
        asn1_files = ["../../asn1/e2sm/e2sm-v5.00.asn",
                      "../../asn1/e2sm/e2sm-kpm-v4.00.asn"]
        self.asn1_compiler = asn1tools.compile_files(asn1_files, "per")

    def pack_event_trigger_def_fmt_1(self, reportingPeriod):
        e2sm_kpm_trigger_def = {
            'eventDefinition-formats': ('eventDefinition-Format1', {'reportingPeriod': reportingPeriod})}
        e2sm_kpm_trigger_def = self.asn1_compiler.encode(
            'E2SM-KPM-EventTriggerDefinition', e2sm_kpm_trigger_def)
        return e2sm_kpm_trigger_def

    def decode_ran_function_styles(self, hex_string):
        byte_string = bytes.fromhex(hex_string)
        ran_function_styles = self.asn1_compiler.decode(
            'E2SM-KPM-RANfunction-Description', byte_string)


test = e2sm_kpm_packer()

srsran_rf_description_encoded = "60304F52414E2D4532534D2D4B504D000018312E332E362E312E342E312E35333134382E312E322E322E3205004B504D204D6F6E69746F720001010700506572696F646963205265706F7274010110010109004532204E6F6465204D6561737572656D656E740101000F004043514901E04452422E416972496644656C6179556C03604452422E5061636B65745375636365737352617465556C674E42557501A04452422E526C6344656C6179556C02C04452422E526C635061636B657444726F7052617465446C02004452422E526C6353647544656C6179446C03804452422E526C635364755472616E736D6974746564566F6C756D65444C03804452422E526C635364755472616E736D6974746564566F6C756D65554C01404452422E5545546870446C01404452422E5545546870556C01A05252552E507262417661696C446C01A05252552E507262417661696C556C01605252552E507262546F74446C01605252552E507262546F74556C0060525352500060525352510101010100010211004532204E6F6465204D6561737572656D656E7420666F7220612073696E676C652055450102000F004043514901E04452422E416972496644656C6179556C03604452422E5061636B65745375636365737352617465556C674E42557501A04452422E526C6344656C6179556C02C04452422E526C635061636B657444726F7052617465446C02004452422E526C6353647544656C6179446C03804452422E526C635364755472616E736D6974746564566F6C756D65444C03804452422E526C635364755472616E736D6974746564566F6C756D65554C01404452422E5545546870446C01404452422E5545546870556C01A05252552E507262417661696C446C01A05252552E507262417661696C556C01605252552E507262546F74446C01605252552E507262546F74556C006052535250006052535251010101010001031600436F6E646974696F6E2D62617365642C2055452D6C6576656C204532204E6F6465204D6561737572656D656E740103000F004043514901E04452422E416972496644656C6179556C03604452422E5061636B65745375636365737352617465556C674E42557501A04452422E526C6344656C6179556C02C04452422E526C635061636B657444726F7052617465446C02004452422E526C6353647544656C6179446C03804452422E526C635364755472616E736D6974746564566F6C756D65444C03804452422E526C635364755472616E736D6974746564566F6C756D65554C01404452422E5545546870446C01404452422E5545546870556C01A05252552E507262417661696C446C01A05252552E507262417661696C556C01605252552E507262546F74446C01605252552E507262546F74556C006052535250006052535251010101020001041580436F6D6D6F6E20436F6E646974696F6E2D62617365642C2055452D6C6576656C204D6561737572656D656E740104000F004043514901E04452422E416972496644656C6179556C03604452422E5061636B65745375636365737352617465556C674E42557501A04452422E526C6344656C6179556C02C04452422E526C635061636B657444726F7052617465446C02004452422E526C6353647544656C6179446C03804452422E526C635364755472616E736D6974746564566F6C756D65444C03804452422E526C635364755472616E736D6974746564566F6C756D65554C01404452422E5545546870446C01404452422E5545546870556C01A05252552E507262417661696C446C01A05252552E507262417661696C556C01605252552E507262546F74446C01605252552E507262546F74556C0060525352500060525352510101010300010511804532204E6F6465204D6561737572656D656E7420666F72206D756C7469706C65205545730105000F004043514901E04452422E416972496644656C6179556C03604452422E5061636B65745375636365737352617465556C674E42557501A04452422E526C6344656C6179556C02C04452422E526C635061636B657444726F7052617465446C02004452422E526C6353647544656C6179446C03804452422E526C635364755472616E736D6974746564566F6C756D65444C03804452422E526C635364755472616E736D6974746564566F6C756D65554C01404452422E5545546870446C01404452422E5545546870556C01A05252552E507262417661696C446C01A05252552E507262417661696C556C01605252552E507262546F74446C01605252552E507262546F74556C00605253525000605253525101010103"
ran_function_description = test.decode_ran_function_styles(
    srsran_rf_description_encoded)

print(ran_function_description)
